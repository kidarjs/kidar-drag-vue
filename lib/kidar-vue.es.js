var t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")(),i=n.Symbol,o=Object.prototype,r=o.hasOwnProperty,s=o.toString,a=i?i.toStringTag:void 0;var l=Object.prototype.toString;var c=i?i.toStringTag:void 0;function f(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":c&&c in Object(t)?function(t){var e=r.call(t,a),n=t[a];try{t[a]=void 0;var i=!0}catch(l){}var o=s.call(t);return i&&(e?t[a]=n:delete t[a]),o}(t):function(t){return l.call(t)}(t)}var u=/\s/;var d=/^\s+/;function h(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&u.test(t.charAt(e)););return e}(t)+1).replace(d,""):t}function p(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var m=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,g=/^0o[0-7]+$/i,y=parseInt;function b(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&"[object Symbol]"==f(t)}(t))return NaN;if(p(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=p(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=h(t);var n=v.test(t);return n||g.test(t)?y(t.slice(2),n?2:8):m.test(t)?NaN:+t}var _=function(){return n.Date.now()},x=Math.max,w=Math.min;function E(t,e,n){var i,o,r,s,a,l,c=0,f=!1,u=!1,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function h(e){var n=i,r=o;return i=o=void 0,c=e,s=t.apply(r,n)}function m(t){return c=t,a=setTimeout(g,e),f?h(t):s}function v(t){var n=t-l;return void 0===l||n>=e||n<0||u&&t-c>=r}function g(){var t=_();if(v(t))return y(t);a=setTimeout(g,function(t){var n=e-(t-l);return u?w(n,r-(t-c)):n}(t))}function y(t){return a=void 0,d&&i?h(t):(i=o=void 0,s)}function E(){var t=_(),n=v(t);if(i=arguments,o=this,l=t,n){if(void 0===a)return m(l);if(u)return clearTimeout(a),a=setTimeout(g,e),h(l)}return void 0===a&&(a=setTimeout(g,e)),s}return e=b(e)||0,p(n)&&(f=!!n.leading,r=(u="maxWait"in n)?x(b(n.maxWait)||0,e):r,d="trailing"in n?!!n.trailing:d),E.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=o=a=void 0},E.flush=function(){return void 0===a?s:y(_())},E}let C,T,S,j,$;const L=t=>{t.style.position="absolute",t.style.width="8px",t.style.height="8px",t.style.backgroundColor="#ffffff",t.style.border="1px solid #333"},N=(()=>{let t;return()=>{if(t)return t;const e=document.createElement("div");e.className="__border_line",e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.border="1px dashed #666";const n=document.createElement("div");n.className="__dot_lt",L(n),n.style.cursor="nw-resize",n.style.left="-4px",n.style.top="-4px";const i=document.createElement("div");i.className="__dot_lb",L(i),i.style.cursor="ne-resize",i.style.left="-4px",i.style.bottom="-4px";const o=document.createElement("div");o.className="__dot_rt",L(o),o.style.cursor="ne-resize",o.style.right="-4px",o.style.top="-4px";const r=document.createElement("div");return r.className="__dot_rb",L(r),r.style.cursor="nw-resize",r.style.right="-4px",r.style.bottom="-4px",t=[e,n,i,o,r],t}})(),O=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return p(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),E(t,e,{leading:i,maxWait:e,trailing:o})}((function(t,e,n,i){C.style.width=n+"px",C.style.height=i+"px",((t,e,n,i)=>{let{offsetHeight:o,offsetWidth:r}=C;e<0&&(e=0),t<0&&(t=0),t+r>T.offsetWidth&&(t=T.offsetWidth-r),e+o>T.offsetHeight&&(e=T.offsetHeight-o),C.style.left=t+"px",C.style.top=e+"px",C.style.right=n+"px",C.style.bottom=i+"px"})(t,e)}),100),k=t=>{t&&t.innerHTML.indexOf("__border_line")>-1&&N().forEach((e=>{t.removeChild(e)}))},H=(t,e)=>t.parentElement===e?((t=>{C!==t&&C&&k(C),-1===t.innerHTML.indexOf("__border_line")&&t.append(...N())})(t),C=t,!0):!!t.parentElement&&H(t.parentElement,e),z=t=>{let{target:e,currentTarget:n,pageX:i,pageY:o}=t;e instanceof HTMLElement&&n instanceof HTMLElement&&(e.className.startsWith("__dot")?(S=e.className.substring(6,8),n.style.cursor="lt"===S||"rb"===S?"nw-resize":"ne-resize"):H(e,n)?(S="move",n.style.cursor="move",j=i-C.offsetLeft,$=o-C.offsetTop):k(C),T=n)};let M;const W=t=>{if(!S)return;let{pageY:e,pageX:n}=t,{offsetLeft:i,offsetTop:o,offsetHeight:r,offsetWidth:s}=C,a=n-T.offsetLeft,l=e-T.offsetTop;switch(S){case"rb":O(i,o,a-i,l-o);break;case"rt":l>o+r&&(l=o+r),O(i,l,a-i,r-l+o);break;case"lt":l>o+r&&(l=o+r),a>i+s&&(a=i+s),O(a,l,s-a+i,r-l+o);break;case"lb":a>i+s&&(a=i+s),O(a,o,s-a+i,l-o);break;case"move":T.style.cursor="move",O(n-j,e-$,s,r)}};var A=(t,e)=>{M=(t=>e=>{S="",T&&(T.style.cursor="auto"),C&&t&&t(C)})(e),t.style.userSelect="none",t.addEventListener("mousedown",z),t.addEventListener("mouseup",M),t.addEventListener("mousemove",W)},D=t=>{t.style.userSelect="inherit",t.removeEventListener("mousedown",z),t.removeEventListener("mouseup",M),t.removeEventListener("mousemove",W),C&&k(C)};function I(t,e,n,i,o,r,s,a){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=l):o&&(l=a?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var f=c.render;c.render=function(t,e){return l.call(e),f(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}const R={};var U=I({name:"KiDragContainer",props:{customAdd:{type:Function},items:{type:Array,default:()=>[]}},watch:{items:{handler:function(t,e){this.$emit("changed",t)},deep:!0}},data:()=>({isCanDel:!0}),mounted(){this.$nextTick((()=>{this.active()}))},beforeDestroy(){this.disable()},methods:{add(t={}){this.customAdd instanceof Function&&(t=this.customAdd()),!t.id&&(t.id=((t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let i=63&n[t];e+=i<36?i.toString(36):i<62?(i-26).toString(36).toUpperCase():i<63?"_":"-"}return e})()),!t.width&&(t.width=100),!t.height&&(t.height=100),this.items.push(t)},deleteItem(t){this.items.splice(t,1)},updateItem(t){let{width:e,height:n,left:i,top:o}=t.style,r=t.getAttribute("dataset-drag-index");this.items[r].width===e&&this.items[r].height===n&&this.items[r].left===i&&this.items[r].top===o||(this.items[r].width=e,this.items[r].height=n,this.items[r].left=i,this.items[r].top=o,this.$emit("changed",this.items))},active(){A(this.$refs.dragContainer,this.updateItem),this.isCanDel=!0},disable(){D(this.$refs.dragContainer),this.isCanDel=!1}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"__drag-container",staticStyle:{display:"flex","flex-direction":"column"}},[n("div",{staticClass:"drag-tools"},[t._t("tools",(function(){return[n("button",{on:{click:function(e){return t.add()}}},[t._v("新增")]),n("button",{on:{click:t.active}},[t._v("启动编辑")]),n("button",{on:{click:t.disable}},[t._v("禁止编辑")])]}))],2),n("div",{ref:"dragContainer",staticStyle:{position:"relative",height:"100%",width:"100%"}},t._l(t.items,(function(e,i){return n("div",{key:e.id,style:"position: absolute;width:"+e.width+"px;height:"+e.height+"px;left:"+e.left+"px;top:"+e.top+"px",attrs:{"dataset-drag-index":i}},[n("div",{staticClass:"__drag-item",staticStyle:{"background-color":"#ffffff",height:"100%",width:"100%",overflow:"hidden",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)"}},[t._t("item",null,{item:e})],2),t.isCanDel?n("button",{staticStyle:{position:"absolute",right:"4px"},on:{click:function(e){return t.deleteItem(i)}}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 24 24",width:"1em",fill:"currentColor"}},[n("path",{attrs:{d:"M0 0h24v24H0V0z",fill:"none"}}),n("path",{attrs:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}})])]):t._e()])})),0)])}),[],!1,X,"76d9dff4",null,null);function X(t){for(let e in R)this[e]=R[e]}var F=function(){return U.exports}();F.install=t=>{t.component(F.name,F)};export{F as default};
