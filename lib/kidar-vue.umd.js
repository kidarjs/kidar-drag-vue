!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).KIDAR_VUE=e()}(this,(function(){"use strict";var t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")(),i=n.Symbol,o=Object.prototype,r=o.hasOwnProperty,s=o.toString,a=i?i.toStringTag:void 0;var l=Object.prototype.toString;var f=i?i.toStringTag:void 0;function c(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":f&&f in Object(t)?function(t){var e=r.call(t,a),n=t[a];try{t[a]=void 0;var i=!0}catch(l){}var o=s.call(t);return i&&(e?t[a]=n:delete t[a]),o}(t):function(t){return l.call(t)}(t)}var u=/\s/;var d=/^\s+/;function h(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&u.test(t.charAt(e)););return e}(t)+1).replace(d,""):t}function p(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var m=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,y=/^0o[0-7]+$/i,g=parseInt;function b(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&"[object Symbol]"==c(t)}(t))return NaN;if(p(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=p(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=h(t);var n=v.test(t);return n||y.test(t)?g(t.slice(2),n?2:8):m.test(t)?NaN:+t}var _=function(){return n.Date.now()},x=Math.max,w=Math.min;function E(t,e,n){var i,o,r,s,a,l,f=0,c=!1,u=!1,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function h(e){var n=i,r=o;return i=o=void 0,f=e,s=t.apply(r,n)}function m(t){return f=t,a=setTimeout(y,e),c?h(t):s}function v(t){var n=t-l;return void 0===l||n>=e||n<0||u&&t-f>=r}function y(){var t=_();if(v(t))return g(t);a=setTimeout(y,function(t){var n=e-(t-l);return u?w(n,r-(t-f)):n}(t))}function g(t){return a=void 0,d&&i?h(t):(i=o=void 0,s)}function E(){var t=_(),n=v(t);if(i=arguments,o=this,l=t,n){if(void 0===a)return m(l);if(u)return clearTimeout(a),a=setTimeout(y,e),h(l)}return void 0===a&&(a=setTimeout(y,e)),s}return e=b(e)||0,p(n)&&(c=!!n.leading,r=(u="maxWait"in n)?x(b(n.maxWait)||0,e):r,d="trailing"in n?!!n.trailing:d),E.cancel=function(){void 0!==a&&clearTimeout(a),f=0,i=l=o=a=void 0},E.flush=function(){return void 0===a?s:g(_())},E}let T,C,N,j,S;const $=t=>{t.style.position="absolute",t.style.width="8px",t.style.height="8px",t.style.backgroundColor="#ffffff",t.style.border="1px solid #333"},L=(()=>{let t;return()=>{if(t)return t;const e=document.createElement("div");e.className="__border_line",e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.border="1px dashed #666";const n=document.createElement("div");n.className="__dot_lt",$(n),n.style.cursor="nw-resize",n.style.left="-4px",n.style.top="-4px";const i=document.createElement("div");i.className="__dot_lb",$(i),i.style.cursor="ne-resize",i.style.left="-4px",i.style.bottom="-4px";const o=document.createElement("div");o.className="__dot_rt",$(o),o.style.cursor="ne-resize",o.style.right="-4px",o.style.top="-4px";const r=document.createElement("div");return r.className="__dot_rb",$(r),r.style.cursor="nw-resize",r.style.right="-4px",r.style.bottom="-4px",t=[e,n,i,o,r],t}})(),O=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return p(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),E(t,e,{leading:i,maxWait:e,trailing:o})}((function(t,e,n,i){T.style.width=Number(n)/Number(C.clientWidth)*100+"%",T.style.height=Number(i)/Number(C.clientHeight)*100+"%",((t,e,n,i)=>{let{offsetHeight:o,offsetWidth:r}=T;e<0&&(e=0),t<0&&(t=0),t+r>C.offsetWidth&&(t=C.offsetWidth-r),e+o>C.offsetHeight&&(e=C.offsetHeight-o),T.style.left=t+"px",T.style.top=e+"px",T.style.right=n+"px",T.style.bottom=i+"px"})(t,e)}),100),H=t=>{t&&t.innerHTML.indexOf("__border_line")>-1&&L().forEach((e=>{t.removeChild(e)}))},k=(t,e)=>t.parentElement===e?((t=>{T!==t&&T&&H(T),-1===t.innerHTML.indexOf("__border_line")&&t.append(...L())})(t),T=t,!0):!!t.parentElement&&k(t.parentElement,e),W=t=>{let{target:e,currentTarget:n,pageX:i,pageY:o}=t;e instanceof HTMLElement&&n instanceof HTMLElement&&(e.className.startsWith("__dot")?(N=e.className.substring(6,8),n.style.cursor="lt"===N||"rb"===N?"nw-resize":"ne-resize"):k(e,n)?(N="move",n.style.cursor="move",j=i-T.offsetLeft,S=o-T.offsetTop):H(T),C=n)};let z;const D=t=>{if(!N)return;let{pageY:e,pageX:n}=t,{offsetLeft:i,offsetTop:o,offsetHeight:r,offsetWidth:s}=T,a=n-C.offsetLeft,l=e-C.offsetTop;switch(N){case"rb":O(i,o,a-i,l-o);break;case"rt":l>o+r&&(l=o+r),O(i,l,a-i,r-l+o);break;case"lt":l>o+r&&(l=o+r),a>i+s&&(a=i+s),O(a,l,s-a+i,r-l+o);break;case"lb":a>i+s&&(a=i+s),O(a,o,s-a+i,l-o);break;case"move":C.style.cursor="move",O(n-j,e-S,s,r)}};var M=(t,e)=>{z=(t=>e=>{N="",C&&(C.style.cursor="auto"),T&&t&&t(T)})(e),t.style.userSelect="none",t.addEventListener("mousedown",W),t.addEventListener("mouseup",z),t.addEventListener("mousemove",D)},I=t=>{t.style.userSelect="inherit",t.removeEventListener("mousedown",W),t.removeEventListener("mouseup",z),t.removeEventListener("mousemove",D),T&&H(T)};function R(t,e,n,i,o,r,s,a){var l,f="function"==typeof t?t.options:t;if(e&&(f.render=e,f.staticRenderFns=n,f._compiled=!0),i&&(f.functional=!0),r&&(f._scopeId="data-v-"+r),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},f._ssrRegister=l):o&&(l=a?function(){o.call(this,(f.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(f.functional){f._injectStyles=l;var c=f.render;f.render=function(t,e){return l.call(e),c(t,e)}}else{var u=f.beforeCreate;f.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:f}}const X={name:"KiDragContainer",props:{editable:{type:Boolean,default:!0},items:{type:Array,default:()=>[]}},watch:{items:{handler:function(t,e){this.$emit("changed",t)},deep:!0},editable:function(t){t?this.active():this.disable()}},data:()=>({isCanDel:!0}),mounted(){this.$nextTick((()=>{this.editable&&this.active()}))},beforeDestroy(){this.disable()},methods:{deleteItem(t,e){this.$emit("delete",t,e)},updateItem(t){let{width:e,height:n,left:i,top:o}=t.style,r=t.getAttribute("dataset-drag-index");this.items[r].width===e&&this.items[r].height===n&&this.items[r].left===i&&this.items[r].top===o||(this.items[r].width=e,this.items[r].height=n,this.items[r].left=i,this.items[r].top=o,this.$emit("changed",this.items))},active(){M(this.$refs.dragContainer,this.updateItem),this.isCanDel=!0},disable(){I(this.$refs.dragContainer),this.isCanDel=!1}}},A={};var U=R(X,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"dragContainer",staticStyle:{position:"relative",height:"100%",width:"100%","background-color":"#f1f1f1"}},t._l(t.items,(function(e,i){return n("div",{key:e.id,style:"position: absolute;width:"+e.width+";height:"+e.height+";left:"+e.left+";top:"+e.top,attrs:{"dataset-drag-index":i}},[n("div",{staticClass:"__drag-item",staticStyle:{height:"100%",width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)"}},[t._t("item",null,{item:e})],2),t.isCanDel?n("button",{staticStyle:{position:"absolute",right:"4px"},on:{click:function(n){return t.deleteItem(i,e)}}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 24 24",width:"1em",fill:"currentColor"}},[n("path",{attrs:{d:"M0 0h24v24H0V0z",fill:"none"}}),n("path",{attrs:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}})])]):t._e()])})),0)}),[],!1,V,null,null,null);function V(t){for(let e in A)this[e]=A[e]}var Y=function(){return U.exports}();return Y.install=t=>{t.component(Y.name,Y)},Y}));
